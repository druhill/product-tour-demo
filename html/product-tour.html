<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Product Tour</title>
    <link href="../css/main.css" rel="stylesheet">

</head>
<body class="small-biz product-tour">
    <header class="score-header collapsed">
        <div class="container full-width">
            <div class="score-column1">
                <div class="score-center">
                    <nav class="score-megamenu">
                        <div class="score-nav-wrapper">
                            <div class="score-nav">
                                <div class="navbar-header score-navbar-header">
                                    <a href="#" class="navbar-brand">
                                        <img src="https://web.pp-sageimagine.com:443/master/-/media/Images/SageDotCom/Master/Logos/sage-logo%20svg.svg?la=en-GB&amp;hash=2C8DDE30339687720EFA01760B8D8533" class="img-responsive" alt="">
                                    </a>
                                    <h1>Sage 50cloud Accounts</h1>
                                    <a class="score-button navbar-btn bn-default sign-up" data-ux-module="score_bootstrap/Components/Button" href="#" target="_blank">Buy now</a>
                                </div>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <div class="page-wrapper">
        <div class="product-tour-wrapper">

            <div class="fixed-background intro">
                <div class="fixed">
                  <video id="pt-intro" src="../dev-assets/videos/Zoom_out_v002_12.mp4" data-trigger="pt-intro-trigger"></video>
                </div>
                <div class="scroll">
                    <div class="container">
                        <div class="flex-panel flex-panel--tall">
                            <span class="gap-header"></span>
                            <span class="gap-stretch intro-offset"></span>
                            <span class="line-block anim1 hidden-md"></span>
                            <div class="intro-holder">
                                <h2 class="sup"><span class="fade">Simple.</span><span class="fade">Smart.</span><span class="fade">Stress-free.</span></h2>
                                <div class="ident-holder">
                                    <button class="play play-lrg" id="pt-intro-trigger" data-targets='["pt-intro"]'>play</button>
                                    <div class="ident">
                                        <h2 class="h3">David Rowe</h2>
                                        <p class="">Owner DPR Motorsports</p>
                                    </div>
                                </div>
                            </div>
                            <span class="line-stretch anim2"></span>
                            <div class="scroll-cta-holder">
                                <button class="scroll-cta" aria-label="click or scroll to continue" data-target="benefits"><img src="../dev-assets/images/scroll.svg" /></button>
                                <div class="scroll-cta-content">
                                    <p>Scroll for features</p>
                                </div>
                            </div>
                            <span class="line-block"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="fixed-background benefits">
                <div class="fixed">

                </div>
                <div class="scroll">
                    <div class="container">
                        <div class="flex-panel">
                            <span class="line-header"></span>
                            <span class="line-stretch hidden-sm"></span>
                            <div class="inset-holder hidden-md">
                                <h2 class="sup fade-in">Features</h2>
                                <p class="fade-in">Explore Sage 50cloud Accounts simple, smart and stress-free features below.</p>
                            </div>
                            <span class="line-header hidden-md"></span>
                        </div>
                        <div class="video-holder-sm">
                            <div class="video-inner">
                                <video id="pt-benefits-sm" data-trigger="pt-benefits-trigger" controls></video>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col4">
                                <div class="flex-panel flex-panel--tall-md">
                                    <span class="line-header"></span>
                                    <span class="line-stretch hidden-sm"></span>
                                    <div class="inset-holder hidden-sm">
                                        <h2 class="sup fade-in">Features</h2>
                                        <p class="fade-in">Explore Sage 50cloud Accounts simple, smart and stress-free features below.</p>
                                    </div>
                                    <span class="line-header hidden-sm"></span>
                                    <div class="controls">
                                        <div class="play-holder">
                                            <span class="line-stretch"></span>
                                            <button class="play" id="pt-benefits-trigger" data-targets='["pt-benefits-sm", "pt-benefits-md"]'>play</button>
                                        </div>
                                        <ul class="acc">
                                            <li class="fade-in">
                                                <button class="h3 trigger" aria-controls="panel-1" aria-expanded="false">Reduce Admin</button>
                                                <div class="holder" id="panel-1">
                                                    <ul>
                                                        <li><a class="video-link" href="../dev-assets/videos/Benefits_Script01_v005.mp4">Introduction</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/01_Setting_up_bank_feeds_v024.mp4">Bank feeds</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/02_Import_from_Excel_&_Uploading_transaction_Manually_PAULA_v009.mp4">Import data</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/03_Enter_multiple_transactions_in_seconds_v005.mp4">Upload receipts as you go</a></li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li class="fade-in">
                                                <button class="h3 trigger" aria-controls="panel-2" aria-expanded="false">Moving Money</button>
                                                <div class="holder" id="panel-2">
                                                    <ul>
                                                        <li><a class="video-link" href="../dev-assets/videos/Benefits_Script02_v005.mp4">Introduction</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/04_Send_invoices_Track_Cash_Flow_v013.mp4">Bespoke invoices</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/05_Make_it_easy_to_pay_v010.mp4">Get paid hassle-free</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/06_Simple_payment_to_suppliers_COLIN_v015.mp4">Simple payments to suppliers</a></li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li class="fade-in">
                                                <button class="h3 trigger" aria-controls="panel-3" aria-expanded="false">Automate Process</button>
                                                <div class="holder" id="panel-3">
                                                    <ul>
                                                        <li><a class="video-link" href="../dev-assets/videos/Benefits_Script03_v005.mp4">Introduction</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/07_Simple_Bank_reconciliation_PAULA_v016.mp4">Simple bank reconciliation</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/08_Update_Invoce_and_Stock_Level_v009.mp4">Update stock levels automatically</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/09_Secure_automated_back_up_for_your_data_PAULA_v015.mp4">Secure, automated backup for your data</a></li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li class="fade-in">
                                                <button class="h3 trigger" aria-controls="panel-4" aria-expanded="false">Simple VAT</button>
                                                <div class="holder" id="panel-4">
                                                    <ul>
                                                        <li><a class="video-link" href="../dev-assets/videos/Benefits_Script04_v005.mp4">Introduction</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/10_Quickly_calculate_VAT_v005">Quickly calculate VAT, make sure its right & easily reconcile</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/11_and_12_Automatically_file returns_online_AND_Audit_Trail_v010.mp4">Automatically file returns online &amp; Audit Trail</a></li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li class="fade-in">
                                                <button class="h3 trigger" aria-controls="panel-5" aria-expanded="false">Deeper Insights</button>
                                                <div class="holder" id="panel-5">
                                                    <ul>
                                                        <li><a class="video-link" href="../dev-assets/videos/Benefits_Script05_v005.mp4">Introduction</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/13_Powerful_reporting_at_our_fingertips_v015.mp4">Powerful reporting at your fingertips</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/14_Check_business_performance_at_a_glance_V009.mp4">Check business performance at a glance</a></li>
                                                        <li><a class="video-link" href="../dev-assets/videos/15_Provide_accurate_and_speedy_insight_with_Sage_Intelligence_v010.mp4">Provide accurate and speedy insight with Sage Intelligence</a></li>
                                                    </ul>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <span class="line-block"></span>
                                </div>
                            </div>

                            <div class="col col8">
                                <div class="video-holder">
                                    <div class="video-inner">
                                        <video id="pt-benefits-md" data-trigger="pt-benefits-trigger" src="../dev-assets/videos/benefits/01_Setting_up_bank_feeds_v021.mp4" controls></video>
                                    </div>
                                    <img class="frame" src="../dev-assets/images/laptop.png" />
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="fixed-background testimonials">
                <div class="fixed" style="background-image: url('../dev-assets/images/desk.png')">
                    <img class="scene-img laptop-btm" src="../dev-assets/images/laptop-btm.png" alt="" />
                    <img class="scene-img cup" src="../dev-assets/images/cup.png" alt="" />
                    <img class="scene-img spanner" src="../dev-assets/images/spanner.png" alt="" />
                    <span class="scene-shadow"></span>
                </div>
                <div class="scroll">
                    <div class="container">
                        <div class="row">
                            <div class="col col6">
                                <div class="flex-panel flex-panel--tall">
                                    <span class="line-header"></span>
                                    <span class="line-stretch hidden-sm"></span>
                                    <div class="ident-holder">
                                        <div class="ident-img">
                                            <img src="../dev-assets/images/head.png" />
                                        </div>
                                        <div class="ident">
                                            <h2 class="h3 fade-in">Derrick Rowe</h2>
                                            <p class="fade-in">Owner DPR Motorsports</p>
                                            <p class="quote fade-in">"Using Sage 50cloud is the best business decision I've ever made, it's helped us be so much more efficient."</p>
                                            <div class="video-holder-sm">
                                                <div class="video-inner">
                                                    <video id="pt-testimonial-sm" data-trigger="pt-testimonial-sm-trigger"  src="../dev-assets/videos/testimonial.mp4" controls></video>
                                                </div>
                                                <button class="play play-green" id="pt-testimonial-sm-trigger" data-targets='["pt-testimonial-sm"]'><img src="../dev-assets/images/play-green.svg" /></button>
                                                <img class="frame" src="../dev-assets/images/ipad.png" />
                                            </div>
                                        </div>
                                    </div>
                                    <span class="line-stretch"></span>
                                    <span class="line-block"></span>
                                </div>
                            </div>
                            <div class="col col6">
                                <div class="video-holder">
                                    <div class="video-inner">
                                        <video id="pt-testimonial-md" data-trigger="pt-testimonial-md-trigger" src="../dev-assets/videos/testimonial.mp4" controls></video>
                                    </div>
                                    <button class="play play-green" id="pt-testimonial-md-trigger" data-targets='["pt-testimonial-md"]'><img src="../dev-assets/images/play-green.svg"/></button>
                                    <img class="frame" src="../dev-assets/images/ipad.png" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="fixed-background signup">
                <div class="fixed">

                </div>
                <div class="scroll">
                    <div class="container">
                        <div class="row">
                            <div class="col col6">
                                <div class="flex-panel flex-panel--tall">
                                    <span class="line-header"></span>
                                    <span class="line-stretch"></span>
                                    <div class="content-holder">
                                        <h2 class="sup fade-in">Switch to Sage 50cloud Accounts</h2>
                                        <a class="score-button button--over-dark fade-in" data-ux-module="score_bootstrap/Components/Button" href="#" target="_blank">Buy now</a>
                                    </div>
                                    <span class="gap-stretch"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
        var introVideo = document.getElementById('pt-intro'),
            benefitsVideoSm = document.getElementById('pt-benefits-sm'),
            benefitsVideoMd = document.getElementById('pt-benefits-md'),
            $videos = $('video'),
            $videoTriggers = $('.play'),
            $controls = $('.benefits .controls'),
            $playHolder = $controls.find('.play-holder'),
            $sections = $('.fixed-background'),
            $fadeIn = $('.fade-in'),
            $scrollCta = $('.scroll-cta'),
            introShouldPause = false;

        var playVideo = function (video) {
            var promise = video.play();

            if (promise !== undefined) {
                promise.then(function () {
                    video.muted = false;
                }, function (reason) {
                    introShouldPause = true;
                    video.muted = true;
                    video.play();
                    console.log(reason.message);
                });
            }
        }

        var controlClickHandler = function (e) {
            var $target = $(e.target),
                $targetHolder = $target.siblings('.holder'),
                height = $targetHolder.find('ul').innerHeight();

            e.preventDefault();

            e.isProgramatic !== true && benefitsFocus();

            $controls.find('.holder').css({ maxHeight: 0 });
            $controls.find('.holder a').attr('tabindex', '-1');
            $controls.find('.acc button').attr('aria-expanded', 'false');

            $targetHolder.css({ maxHeight: height });
            $targetHolder.find('a').attr('tabindex', '0');
            $target.attr('aria-expanded', 'true');

            $playHolder.toggleClass('is-linked', $targetHolder.hasClass('is-controlled'));

            // use this to trigger the first video while opening the accordian section
            /*e.isProgramatic !== true && setTimeout(function () {
                videoClickHandler({ target: $targetHolder.find('a')[0], preventDefault: function () { }, isProgramatic: true });
            }, 400);*/
            
            return false;
        }

        var benefitsFocus = function () {
            var benefitsOffset = $sections.filter('.benefits').offset().top;

            if (benefitsOffset > window.pageYOffset) {
                window.scrollTo({
                  top: benefitsOffset,
                  left: 0,
                  behavior: 'smooth'
                });
            }
        }

        var videoClickHandler = function (e) {
            var $target = $(e.target),
                $targetHolder = $target.parents('.holder'),
                href = e.target.href,
                offset = $target.offset().top - $controls.offset().top + 40,
                targetVideo = $(benefitsVideoSm).is(':visible') ? benefitsVideoSm : benefitsVideoMd;

            e.preventDefault();

            e.isProgramatic !== true && benefitsFocus();

            targetVideo.setAttribute('src', href);
            playVideo(targetVideo);

            $playHolder.height(offset);
            $playHolder.addClass('is-linked');

            $controls.find('.holder').removeClass('is-controlled');
            $targetHolder.addClass('is-controlled');

            return false;
        }

        introVideo.addEventListener("timeupdate", function () {
            if (introShouldPause && this.currentTime > 4) {
                this.pause();
                introShouldPause = false;
            }
        });

        introVideo.addEventListener("ended", function () {
            //todo: switch/fade to zoomed out video
        });

        introVideo.addEventListener("canplay", function () {
            playVideo(introVideo);
        });

        $videos.on("play pause ended", function (e) {
            var $trigger = $('#' + e.target.getAttribute('data-trigger'));

            switch (e.type) {
                case 'play':
                    $trigger.addClass('is-playing');
                    break;
                case 'pause':
                    $trigger.removeClass('is-playing');
                    break;
                case 'ended':
                    $trigger.removeClass('is-playing');
                    break;
                default:
                    return false;
            }
        });

        $videoTriggers.on("click", function (e) {
            var targetVideos = $(e.target).data('targets'),
                targetVideo = $('#' + targetVideos[0]).is(':visible') ? document.getElementById(targetVideos[0]) : document.getElementById(targetVideos[1]),
                isVideoPlaying = function (video) { return !!(video.currentTime > 0 && !video.paused && !video.ended && video.readyState > 2) };

            isVideoPlaying(targetVideo) ? targetVideo.pause() : playVideo(targetVideo);
        });        

        function updateSections() {
            var windowOffset = window.innerHeight * .4;

            $sections.each(function () {
                var $el = $(this),
                    offset = this.offsetTop - window.pageYOffset;

                if (offset + this.offsetHeight < windowOffset) {
                    $el.removeClass('is-current').addClass('is-complete');
                    $el.find('video').each(function (i, el) {
                        el.pause();
                    });
                } else if (offset < windowOffset) {
                    $el.removeClass('is-complete').addClass('is-current');
                } else {
                    $el.removeClass('is-current is-complete');
                    $el.find('video').each(function (i, el) {
                        el.pause();
                    });
                }
            })
        }

        $controls.find('.acc .trigger').on("click", controlClickHandler);
        $controls.find('.acc .video-link').on("click", videoClickHandler);

        $scrollCta.on("click", function (e) {
            var target = this.getAttribute('data-target'),
                offset = $sections.filter('.' + target).offset().top;

            window.scrollTo({
              top: offset,
              left: 0,
              behavior: 'smooth'
            });
        });

        $(window).on("scroll resize", function () {

            $fadeIn.each(function (i, el) {
                var $el = $(el);

                if ($el.offset().top < window.pageYOffset + window.innerHeight) {
                    $el.addClass('visible');
                }
            });

            updateSections();
        });

        $controls.find('.holder').first().addClass('is-controlled');
        controlClickHandler({ target: $controls.find('.acc .trigger')[0], preventDefault: function () { }, isProgramatic: true });

        $sections.filter('.intro').find('.sup').on('animationend', function (e) {
            $(e.target).parents('.fixed-background').addClass('offset');
        })

    </script>
</body>
</html>